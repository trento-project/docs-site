name: docs
title: Trento
version: ~
nav:
- modules/trento_documentation/nav.adoc
- modules/agent/nav_agent.adoc
- modules/ansible/nav_ansible.adoc
- modules/checks/nav_checks.adoc
- modules/helm-charts/nav_helm_charts.adoc
- modules/web/nav_web.adoc
- modules/api/nav_api.adoc
- modules/docs/nav_docs.adoc
- modules/workbench/nav_workbench.adoc

ext: 
  collector:
    ## Remove previous documentation
    - clean:
        - dir: antora_public
        - dir: tmp_docs
    ## Documentation Fetching from diffrent upstream repositories
    - run:
        - command: git clone --depth 1 https://github.com/trento-project/docs.git tmp_docs/docs
        - command: git clone --depth 1 https://github.com/SUSE/doc-unversioned tmp_docs/docs_repo
        - command: git clone --branch antora_readme --depth 1 https://github.com/trento-project/web.git tmp_docs/web
        - command: git clone --depth 1 https://github.com/trento-project/agent tmp_docs/agent
        - command: git clone --depth 1 https://github.com/trento-project/helm-charts tmp_docs/helm-charts 
        - command: git clone --branch md_to_adoc --depth 1 https://github.com/trento-project/ansible tmp_docs/ansible
        - command: git clone --branch md_to_adoc --depth 1 https://github.com/trento-project/checks tmp_docs/checks
        - command: git clone --depth 1 git@github.com:trento-project/workbench.git tmp_docs/workbench

  # Trento official documentation
    - scan:
      - dir: tmp_docs/docs_repo/trento/adoc
        files: '**/*.adoc'
        into: modules/trento_documentation/pages
      - dir: tmp_docs/docs_repo/trento/images/src/png
        files: '**/*.png'
        into: modules/trento_documentation/images
    - run:
        command: ./scripts/generate-attributes-yaml.sh ./tmp_docs/docs_repo/trento/adoc/generic-attributes.adoc ./tmp_docs/docs_repo/antora_tmp/antora.yml
    - scan:
        dir: ./tmp_docs/docs_repo/antora_tmp
        files: 'antora.yml'

# Trento documentation repository
    - scan:
      - dir: tmp_docs/docs/
        files: 'README.adoc'
        into: modules/web/pages
      - dir:  tmp_docs/docs/
        files: '**/*.adoc'
        into: modules/docs/pages/
      - dir: tmp_docs/docs/images/
        files: '**/*.{png,jpg,jpeg,svg,gif}'
        into: modules/docs/images/images

# Trento upstream projects documentation
    ## Trento Web
    - scan:
      - dir: tmp_docs/web/
        files: 'README.adoc'
        into: modules/web/pages
      - dir: tmp_docs/web/guides
        files: '**/*.adoc'
        into: modules/web/pages/
      - dir: tmp_docs/web/guides/
        files: '**/*.{png,jpg,jpeg,svg,gif}'
        into: modules/web/images/
    ## Trento Agent
    - scan:
      - dir: tmp_docs/agent/
        files: '*.adoc'
        into: modules/agent/pages
      - dir: tmp_docs/agent/docs
        files: '**/*.adoc'
        into: modules/agent/pages
    ## Trento Helm
    - scan:
      - dir: tmp_docs/helm-charts/
        files: '*.adoc'
        into: modules/helm-charts/pages
      - dir: tmp_docs/helm-charts/docs
        files: '**/*.adoc'
        into: modules/helm-charts/pages
    ## Trento Ansible
    - scan:
      - dir: tmp_docs/ansible
        files: '*.adoc'
        into: modules/ansible/pages
    ## Trento Checks
    - scan:
      - dir: tmp_docs/checks
        files: '*.adoc'
        into: modules/checks/pages
    ## Trento Workbench
    - scan:
      - dir: tmp_docs/workbench
        files: '*.adoc'
        into: modules/workbench/pages
      - dir: tmp_docs/workbench
        files: '**/*.{png,jpg,jpeg,svg,gif}'
        into: modules/workbench/images